{{page-title "Avitar Building Permits - Streamline Your Permit Process"}}

<div class="home-landing">
  <header class="landing-header">
    <div class="container">
      <div class="row items-center">
        <div class="col-md-8">
          <div class="brand-section">
            <div class="brand-icon">üèõÔ∏è</div>
            <div class="brand-content">
              <h1 class="brand-title">Avitar Building Permits</h1>
              <p class="brand-subtitle">Streamline your building permit process across municipalities</p>
            </div>
          </div>
        </div>
        <div class="col-md-4 text-right">
          <div class="header-actions">
            <button type="button" class="btn btn-outline-secondary btn-sm" {{on "click" this.showMunicipalityRegistration}}>
              + Register Municipality
            </button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="landing-main">
    <div class="container">
      <div class="row justify-center">
        <div class="col-lg-10 col-xl-8">
          <div class="auth-card card shadow-lg">
            <div class="card-body p-5">
              <!-- Auth Toggle -->
              <div class="auth-toggle mb-4">
                <div class="btn-group w-100" role="group">
                  <button 
                    type="button" 
                    class="btn {{if this.showSignIn 'btn-primary' 'btn-outline-primary'}} toggle-btn"
                    {{on "click" this.showSignInForm}}
                  >
                    Sign In
                  </button>
                  <button 
                    type="button" 
                    class="btn {{if this.showSignUp 'btn-primary' 'btn-outline-primary'}} toggle-btn"
                    {{on "click" this.showSignUpForm}}
                  >
                    Sign Up
                  </button>
                </div>
              </div>

              {{#if this.showSignIn}}
                <!-- Sign In Section -->
                <div class="sign-in-section">
                  <div class="welcome-content text-center mb-4">
                    <h2>Welcome Back</h2>
                    <p class="text-muted">Sign in to your account</p>
                  </div>

                  <div class="signin-flow-container">
                    {{#unless this.selectedUserType}}
                      <!-- User Type Selection -->
                      <div class="user-type-selection">
                        <label class="form-label">Account Type</label>
                        <div class="user-type-buttons">
                          <button 
                            type="button" 
                            class="user-type-btn"
                            {{on "click" (fn this.selectUserType 'residential')}}
                          >
                            <div class="user-type-icon">üè†</div>
                            <div class="user-type-label">Residential</div>
                            <div class="user-type-desc">Homeowner permits</div>
                          </button>
                          <button 
                            type="button" 
                            class="user-type-btn"
                            {{on "click" (fn this.selectUserType 'commercial')}}
                          >
                            <div class="user-type-icon">üè¢</div>
                            <div class="user-type-label">Commercial</div>
                            <div class="user-type-desc">Multi-municipality</div>
                          </button>
                          <button 
                            type="button" 
                            class="user-type-btn"
                            {{on "click" (fn this.selectUserType 'municipal')}}
                          >
                            <div class="user-type-icon">üèõÔ∏è</div>
                            <div class="user-type-label">Municipal</div>
                            <div class="user-type-desc">Staff portal</div>
                          </button>
                          <button 
                            type="button" 
                            class="user-type-btn"
                            {{on "click" (fn this.selectUserType 'system_admin')}}
                          >
                            <div class="user-type-icon">üîß</div>
                            <div class="user-type-label">System Admin</div>
                            <div class="user-type-desc">Platform admin</div>
                          </button>
                        </div>
                      </div>
                    {{else}}
                      <!-- Back Button and Selected Type -->
                      <div class="selected-type-header">
                        <button 
                          type="button" 
                          class="back-btn"
                          {{on "click" this.clearUserType}}
                        >
                          ‚Üê Back to Account Types
                        </button>
                        <div class="selected-type-info">
                          {{#if (eq this.selectedUserType 'residential')}}
                            <div class="selected-type-icon">üè†</div>
                            <div class="selected-type-text">
                              <h3>Residential Sign In</h3>
                              <p>Sign in to your homeowner account</p>
                            </div>
                          {{else if (eq this.selectedUserType 'commercial')}}
                            <div class="selected-type-icon">üè¢</div>
                            <div class="selected-type-text">
                              <h3>Commercial Sign In</h3>
                              <p>Sign in to your business account</p>
                            </div>
                          {{else if (eq this.selectedUserType 'municipal')}}
                            <div class="selected-type-icon">üèõÔ∏è</div>
                            <div class="selected-type-text">
                              <h3>Municipal Staff Sign In</h3>
                              <p>Sign in to the staff portal</p>
                            </div>
                          {{else if (eq this.selectedUserType 'system_admin')}}
                            <div class="selected-type-icon">üîß</div>
                            <div class="selected-type-text">
                              <h3>System Admin Sign In</h3>
                              <p>Sign in to the admin portal</p>
                            </div>
                          {{/if}}
                        </div>
                      </div>

                      <!-- Sign In Form -->
                      <div class="signin-form-container">
                        {{#if (eq this.selectedUserType 'commercial')}}
                          <CommercialSignInForm />
                        {{else if (eq this.selectedUserType 'residential')}}
                          <UniversalSignInForm @userType="residential" @requiresMunicipality={{true}} @municipalities={{this.municipalities}} />
                        {{else if (eq this.selectedUserType 'municipal')}}
                          <UniversalSignInForm @userType="municipal" @requiresMunicipality={{true}} @municipalities={{this.municipalities}} />
                        {{else if (eq this.selectedUserType 'system_admin')}}
                          <SystemAdminSignInForm />
                        {{/if}}
                      </div>
                    {{/unless}}
                  </div>
                </div>

              {{else if this.showSignUp}}
                <!-- Sign Up Section -->
                <div class="sign-up-section">
                  <div class="welcome-content text-center mb-4">
                    <h2>Create Your Account</h2>
                    <p class="text-muted">Join the streamlined permit process</p>
                  </div>

                  <div class="signup-flow-container">
                    {{#unless this.selectedSignUpType}}
                      <!-- User Type Selection for Signup -->
                      <div class="user-type-selection">
                        <label class="form-label">Account Type</label>
                        <div class="signup-user-types">
                          <button 
                            type="button" 
                            class="user-type-btn"
                            {{on "click" (fn this.selectSignUpType 'residential')}}
                          >
                            <div class="user-type-icon">üè†</div>
                            <div class="user-type-label">Residential</div>
                            <div class="user-type-desc">For homeowners applying for permits</div>
                          </button>
                          <button 
                            type="button" 
                            class="user-type-btn"
                            {{on "click" (fn this.selectSignUpType 'commercial')}}
                          >
                            <div class="user-type-icon">üè¢</div>
                            <div class="user-type-label">Commercial</div>
                            <div class="user-type-desc">For businesses working across municipalities</div>
                          </button>
                        </div>
                      </div>
                    {{else}}
                      <!-- Back Button and Selected Type -->
                      <div class="selected-type-header">
                        <button 
                          type="button" 
                          class="back-btn"
                          {{on "click" this.clearSignUpType}}
                        >
                          ‚Üê Back to Account Types
                        </button>
                        <div class="selected-type-info">
                          {{#if (eq this.selectedSignUpType 'residential')}}
                            <div class="selected-type-icon">üè†</div>
                            <div class="selected-type-text">
                              <h3>Create Residential Account</h3>
                              <p>Set up your homeowner account</p>
                            </div>
                          {{else if (eq this.selectedSignUpType 'commercial')}}
                            <div class="selected-type-icon">üè¢</div>
                            <div class="selected-type-text">
                              <h3>Create Commercial Account</h3>
                              <p>Set up your business account</p>
                            </div>
                          {{/if}}
                        </div>
                      </div>

                      <!-- Sign Up Forms -->
                      <div class="signup-form-container">
                        {{#if (eq this.selectedSignUpType 'residential')}}
                          <ResidentialSignUpWithMunicipalitySelector @municipalities={{this.municipalities}} />
                        {{else if (eq this.selectedSignUpType 'commercial')}}
                          <CommercialSignUpForm />
                        {{/if}}
                      </div>
                    {{/unless}}
                  </div>
                </div>
              {{/if}}
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>