<div class="users-manager">
  <div class="section-header">
    <h2>ðŸ‘¥ User Management</h2>
    <p class="section-description">Manage all system users across municipalities</p>
  </div>

  <div class="filters-section mb-4">
    <div class="row align-items-center">
      <div class="col-md-4">
        <label for="userTypeFilter" class="form-label">Filter by User Type:</label>
        <select 
          id="userTypeFilter" 
          class="form-select"
          value="{{this.selectedUserType}}"
          {{on "change" this.filterByUserType}}
        >
          <option value="all">All Users</option>
          <option value="system_admin">System Admins</option>
          <option value="municipal">Municipal Staff</option>
          <option value="residential">Residential</option>
          <option value="commercial">Commercial</option>
        </select>
      </div>
      <div class="col-md-8">
        <div class="d-flex justify-content-end align-items-center">
          <span class="text-muted me-3">
            {{this.totalUsers}} total users
          </span>
        </div>
      </div>
    </div>
  </div>

  {{#if this.isLoading}}
    <div class="loading-state">
      <p>Loading users...</p>
    </div>
  {{else if this.error}}
    <div class="alert alert-danger">
      <strong>Error loading users:</strong> {{this.error}}
    </div>
  {{else}}
    <div class="users-table-container">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>User</th>
            <th>Type</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Status</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {{#each this.users as |user|}}
            <tr>
              <td>
                <div class="user-info">
                  <div class="user-avatar user-avatar-{{user.userType}}">
                    {{user.initials}}
                  </div>
                  <div class="user-details">
                    <div class="user-name">{{user.firstName}} {{user.lastName}}</div>
                  </div>
                </div>
              </td>
              <td>
                <span class="badge badge-{{user.userType}}">
                  {{user.userType}}
                </span>
              </td>
              <td>
                <a href="mailto:{{user.email}}">{{user.email}}</a>
              </td>
              <td>{{user.phone}}</td>
              <td>
                {{#if user.isActive}}
                  <span class="badge bg-success">Active</span>
                {{else}}
                  <span class="badge bg-secondary">Inactive</span>
                {{/if}}
              </td>
              <td>{{user.createdAt}}</td>
              <td>
                <div class="user-actions">
                  {{#if user.isActive}}
                    <button type="button" class="btn btn-outline-warning btn-xs mb-1" {{on "click" (fn this.deactivateUser user)}}>
                      Deactivate
                    </button>
                  {{else}}
                    <button type="button" class="btn btn-outline-success btn-xs mb-1" {{on "click" (fn this.activateUser user)}}>
                      Activate
                    </button>
                  {{/if}}
                  <button type="button" class="btn btn-outline-info btn-xs" {{on "click" (fn this.resetPassword user)}}>
                    Reset Pwd
                  </button>
                </div>
              </td>
            </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  {{/if}}
</div>