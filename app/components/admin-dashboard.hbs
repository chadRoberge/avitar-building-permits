<div class="municipal-dashboard admin-dashboard">
  <div class="dashboard-header">
    <h1>System Administration Dashboard</h1>
    <p>Manage municipalities, users, and system-wide settings</p>
  </div>

  {{#if this.isLoading}}
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Loading dashboard data...</p>
    </div>
  
  {{else if this.error}}
    <div class="error-state">
      <div class="error-icon">‚ö†Ô∏è</div>
      <h3>Error Loading Dashboard</h3>
      <p>{{this.error}}</p>
      <button type="button" class="btn btn-primary" {{on "click" this.loadDashboardData}}>
        Retry
      </button>
    </div>

  {{else if this.dashboardData}}
    {{! Metrics Cards - Using municipal dashboard styling }}
    <div class="metrics-grid">
      {{#each this.overviewCards as |card|}}
        <div 
          class="metric-card {{if card.action 'clickable'}}"
          {{on "click" card.action}}
        >
          <div class="metric-icon">{{card.icon}}</div>
          <div class="metric-content">
            <h3>{{card.title}}</h3>
            <div class="metric-value">{{card.value}}</div>
            {{#if card.subtitle}}
              <div class="metric-subtitle">{{card.subtitle}}</div>
            {{/if}}
          </div>
        </div>
      {{/each}}
    </div>

    {{! Main Dashboard Grid - Using municipal dashboard styling }}
    <div class="dashboard-grid">
      {{! Analytics Section }}
      <div class="dashboard-section">
        <h2>System Analytics</h2>
        <div class="status-grid">
          {{#each this.userTypeChart as |item|}}
            <div class="status-item">
              <div class="status-label">{{item.label}}</div>
              <div class="status-value">{{item.value}}</div>
              <div class="status-bar">
                <div class="status-fill" style="width: {{item.percentage}}%"></div>
              </div>
            </div>
          {{/each}}
        </div>
      </div>

      <div class="dashboard-section">
        <h2>Permit Overview</h2>
        <div class="status-grid">
          {{#each this.permitStatusChart as |item|}}
            <div class="status-item">
              <div class="status-label">{{item.label}}</div>
              <div class="status-value">{{item.value}}</div>
              <div class="status-bar">
                <div class="status-fill" style="width: {{item.percentage}}%"></div>
              </div>
            </div>
          {{/each}}
        </div>
      </div>

      {{! Recent Activity Section }}
      <div class="dashboard-section">
        <h2>Recent Users</h2>
        <div class="activity-list">
          {{#each this.dashboardData.recent.users as |user|}}
            <div class="activity-item">
              <div class="activity-icon">
                {{this.getInitials user.firstName user.lastName}}
              </div>
              <div class="activity-content">
                <div class="activity-title">
                  {{user.firstName}} {{user.lastName}}
                </div>
                <div class="activity-details">
                  {{user.email}} ‚Ä¢ {{this.formatUserType user.userType}}
                </div>
                <div class="activity-time">
                  {{format-datetime user.createdAt}}
                </div>
              </div>
            </div>
          {{else}}
            <div class="empty-state">No recent users</div>
          {{/each}}
        </div>
      </div>

      <div class="dashboard-section">
        <h2>Recent Permits</h2>
        <div class="activity-list">
          {{#each this.dashboardData.recent.permits as |permit|}}
            <div class="activity-item">
              <div class="activity-icon">üìã</div>
              <div class="activity-content">
                <div class="activity-title">
                  {{permit.permitNumber}} - {{permit.type}}
                </div>
                <div class="activity-details">
                  {{#if permit.municipalityId}}
                    {{permit.municipalityId.name}}
                  {{/if}}
                  ‚Ä¢ Status: {{permit.status}}
                </div>
                <div class="activity-time">
                  {{format-datetime permit.createdAt}}
                </div>
              </div>
            </div>
          {{else}}
            <div class="empty-state">No recent permits</div>
          {{/each}}
        </div>
      </div>

      {{! Quick Actions }}
      <div class="dashboard-section quick-actions-section">
        <h2>Quick Actions</h2>
        <div class="activity-list">
          <div class="activity-item clickable" {{on "click" this.navigateToMunicipalities}}>
            <div class="activity-icon">üèõÔ∏è</div>
            <div class="activity-content">
              <div class="activity-title">Manage Municipalities</div>
              <div class="activity-details">View and configure municipality settings</div>
            </div>
          </div>
          
          <div class="activity-item clickable" {{on "click" this.navigateToUsers}}>
            <div class="activity-icon">üë•</div>
            <div class="activity-content">
              <div class="activity-title">Manage Users</div>
              <div class="activity-details">Monitor system-wide user activity</div>
            </div>
          </div>
          
          <div class="activity-item clickable" {{on "click" this.navigateToSettings}}>
            <div class="activity-icon">‚öôÔ∏è</div>
            <div class="activity-content">
              <div class="activity-title">System Settings</div>
              <div class="activity-details">Configure global system parameters</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  {{/if}}
</div>